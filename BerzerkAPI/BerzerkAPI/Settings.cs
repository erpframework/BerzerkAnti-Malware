using BerzerkAPI.Security;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;

namespace BerzerkAPI
{
    /// <summary>
    /// Static, shared settings library to configure various scan settings. This class will later be converted to a controller in which will save and load settings from a file in order to provide a customizable user experience.  
    /// </summary>
    public class Settings
    {
        public static Encryption CryptoProvider { get; set; }
        public static int MaxFileSize { get; set; }

        //public static List<string> ScannableFiles { get; set; }
        public static HashSet<string> ScannableFiles { get; set; }
        public static HashSet<string> WhiteList { get; set; }

        public static int BufferSize { get; set; }

        public static bool ReducePriority { get; set; }

        public static void Defaults()
        {
            // Default Max File Size to scan is 25 MB 
            MaxFileSize = (1024 * 1024) * 100;

            // Load Scannable files 
            //ScannableFiles = new List<string>();
            ScannableFiles = new HashSet<string>();

            // Load the resource file with default executable extentions 
            string[] ext = BerzerkAPI.Properties.Resources.DefaultExtensions.Split('\n');

            // Loop and add each default extention 
            foreach(string xt in ext)
            {
                // Remove \r from windows new line splits, and convert to lower... 
                ScannableFiles.Add(xt.Replace("\r", "").ToLower());
            }

            // Load white list ? 
            WhiteList = new HashSet<string>();

            // Setup an optimized buffer... 
            if (Environment.Is64BitOperatingSystem)
                BufferSize = 64;
            else
                BufferSize = 32;


            // Setup crypto provider
            CryptoProvider = new Security.Encryption()
            {
                PrivateKey = "AAAbbb###123",
                PublicKey = "BerzerkAnti-Malware2016"
            };

            // setup more default settings
            ReducePriority = false; 
        }
    }
}
